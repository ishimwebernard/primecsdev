<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet"> 
    <link rel="stylesheet" href="../css/lessons.css">
    <title>Student Dashboard</title>
</head>
<body>
    <div class="content">
        <div class="accountcontrol" id="accountcontrol" onclick="endAccountControlSession()">
        </div>
        <div class="center" id="center">
            <img alt="" role="img" id="userProfile">
            <input type="file" accept="image/png, image/jpeg" id="choosefile" hidden>
            <label for="choosefile" id="pictureChanger">CHANGE PROFILE PICTURE</label>
            <small>ENROLLED PROGRAMS</small>
            <div class="enrollmentCLASSES" id="enrollmentCLASSES">
            </div>
          </div>
        <div class="loader" id="loader">
            <div class="lc">
                <img src="../assets/images/loading.gif" alt="">
            <h2>Loading ...</h2>
            </div>
        </div>
        <div class="col1">
            <img src="../assets/images/logo.png" alt="" class="logo">
            <div class="navGroup">
                <img src="../assets/images/home.png" alt="">
                <h2 class="clickItem" onclick="switchTabFor(0)">Home</h2>
            </div>
            <div class="navGroup">
                <img src="../assets/images/help.png" alt="">
                <h2 class="clickItem" onclick="switchTabFor(1)">Help</h2>
            </div>
            <div class="out">
                <img src="../assets/images/out.png" alt="">
                <h2 onclick="logout()">Logout</h2>
            </div>
            <div class="out" onclick="startAccountControlSession()">
                <img src="../assets/images/account.png" alt="">
                <h2>Account</h2>
            </div>


        </div>
        <div class="mainNavigator">
            <div class="col2" id="home">
                <div class="row1">
                    <div class="img" src="" alt="" id="userprofilepicture" onclick="startAccountControlSession()"></div>
                    <h1>Home</h1>

                </div>
                <div class="row2">
                    
                    <div class="card" id="enrolledPrograms">
                        <small>ENROLLED PROGRAMS</small>
                        
                    </div>
                    <div class="card" id="nothing">
                        <img src="../assets/images/empty.png" alt="">
                        <h2>Nothing to Show</h2>
                       
                    </div>
                    <div class="card" id="programstoEnrlss">
                        <small>AVAILABLE PROGRAMS</small>
                        <div class="rectangle">
                            <h3>AEC360 Business</h3>
                            <p>A business is defined as an organization or enterprising entity engaged in commercial, industrial, or professional activities. Businesses can be for-profit entities or they can be non-profit organizations that operate to fulfill a charitable </p>
                            <button onclick="enroll(`AEC360 Business`)">Enroll</button>
                        </div>       
                        <div class="rectangle">
                            <h3>AEC360 Professional</h3>
                            <p>A business is defined as an organization or enterprising entity engaged in commercial, industrial, or professional activities. Businesses can be for-profit entities or they can be non-profit organizations that operate to fulfill a charitable </p>
                            <button onclick="enroll(`AEC360 Professional`)">Enroll</button>
                        </div> 
                        <div class="rectangle">
                            <h3>AEC360 Executive
                            </h3>
                            <p>A business is defined as an organization or enterprising entity engaged in commercial, industrial, or professional activities. Businesses can be for-profit entities or they can be non-profit organizations that operate to fulfill a charitable </p>
                            <button onclick="enroll(`AEC360 Executive`)">Enroll</button>
                        </div> 
                        <div class="rectangle">
                            <h3>AEC360 Custom
                            </h3>
                            <p>A business is defined as an organization or enterprising entity engaged in commercial, industrial, or professional activities. Businesses can be for-profit entities or they can be non-profit organizations that operate to fulfill a charitable </p>
                            <button onclick="enroll(`AEC360 Custom`)">Enroll</button>
                        </div> 
                    </div>
                    
                </div>
            </div>
            <div class="col2" id="helpfiles">
                <div class="row1">
                    <h1>Help Files</h1>

                </div>
                      <div class="row2">
                        <div class="rectangle">
                            <div class="r1">
                                <img src="../assets/images/gettingStarted.png" alt="">
                                <h2>Getting Started</h2>
                            </div>
                            <p>Main information aboutn the programs</p>
                            <button onclick="switchTabFor(2)">Get Started</button>    

                        </div>       
                        <div class="rectangle">
                            <div class="r1">
                                <img src="../assets/images/faqs.png" alt="">

                                <div class="m">
                                    <h2>Other help and FAQS</h2>
                                <p>Main information aboutn the programs</p>
                                <button>View FAQs</button>    
                                </div>
                            </div>
                        </div>
                      </div>
            </div>
            <div class="col2" id="helpfiles">
                <div class="row1">
                    <h1>Getting Started</h1>

                </div>
                <div class="row2">
                    <h1>AEC360 LEARNING INITIATIVE</h1>
                    <h2>1.	Background</h2>
                    <p>
      
                      The most common cause of failure on large infrastructure development projects remains the lack of proper organization.  This is in addition to a shortage of competent professionals, an industrywide reluctance to consider and adopt innovative solutions, and a lack of knowledge of international codes and standards. Historically, humans were multidisciplined master builders skilled to design, build, and operate infrastructure. As we evolved, infrastructure became too complex for a traditional master builder. Currently, design and construction teams comprise a large number of specialists - individuals with an in-depth knowledge, often of only their own specialty.  This, regrettably, has made it easier to revert to an uncollaborative, siloed mentality that often neglects to work toward holistic, integrated design and construction solutions.  Efforts to correct this cost excessive time and money. <br><br>
                      <br>
                      Today, the rise of megaprojects designed for 100 years or longer requires advanced sophistication and expeditious delivery. Efficiency, economy, integration, and strict adherence to standards and codes are now expected.  This situation begs the return of a master-builder who can unify diverse teams and integrate objectives and technologies for the best possible solution.  Such a master-builder takes a whole-life approach and considers the asset's design, construction, operation, and maintenance. This reinvention remains unfamiliar to many. Particularly, Africa and other developing regions have an opportunity to adapt swiftly and shape a future built on a solid footing.
      
                    </p>
                    <h2>2.	AEC360 LI Overview</h2>
                    <p>
                      The AEC360 Learning Initiative (AEC360 LI) is a unique educational initiative created by PrimECS LLC, a US-based infrastructure consultant providing construction engineering, management, and educational services.  AEC360 LI strengthens technical competencies and studies the integrated master-builder delivery (alternative delivery) approach for large infrastructure projects. We promote project integration beyond traditional collaboration and coordination while providing local and international self-growth opportunities in the AEC industry. Once graduated, participants are welcomed into our highly interactive community, where we continue to grow and exchange experiences via:<br><br>
      	professional development events - seminars, conferences, masterminds, and study trips;<br>
      	coaching, mentoring, and self-directed learning guidance; and <br>
      	AEC industry-related content creation and publishing. <br>
      
                      
                    </p>
                    <h2>3.	 Mission and Objectives</h2>
                    <p>
                      Starting with Rwanda, we connect African and US-based resources to promote the exchange of skills and opportunities. We lead the infrastructure industry through the 21st century's social, economic, and technological evolutions while creating opportunities for the less affluent. We do so by: <br>
      	inspiring young talent to seize AEC industry opportunities for professional and personal fulfillment;<br>
      	growing current and future AEC professionals and leaders to internationally competitive levels; and<br>
      	providing infrastructure builders with a pool of highly competent project leaders and experts.<br>
      
                    </p>
                    <h2>4.	Key Programs </h2>
                    <p>
                      We currently offer the following primary programs:
      	AEC360 Pro: Designed for University students and professionals with less than five years of experience, this entry-level program introduces the AEC industry's fundamentals, providing required skills to realize a full project delivery cycle from inception to closeout.  We confer on what we do and how to do it best.  The first cohort began the program in October 2020.
      	AEC360 Expert: This intermediate-level program generally caters to AEC professionals with more than five years of experience.  At this level, one is a crucial player on a project and must know the work.  This customized program focuses on leading day-to-day technical and operational activities at the middle manager level. The first cohort for this program is scheduled for Winter/Spring 2021. 
      	AEC360 Exec: At executive and senior manager levels, problems are complex.  Our advanced coursework equips business operators and owners with the tools to handle a wide range of high-level technical, commercial, and social issues.  We promote exchange, encourage networking, and facilitate partnerships.  We plan to begin this program as early as Spring 2021. 
      	AEC360 Custom: Here, we collaboratively customize programs to address group, individual, or region-specific challenges/needs such as flooding and landslides in mountainous regions. 
      
                    </p>
                    <h2>
                        5.	Course Delivery
                    </h2>
                    <p>
                        Our programs typically last 15 to 18 contact hours.  More compressed or extended versions are available on request.  The cohort size is based on the venue, mode of delivery, and the sponsor's preferences. We have adjusted to current Covid-19 avoidance guidelines and are currently conducting programs virtually. We plan to commence in-person events as soon as practicable.
                    </p>
                    <h2>
                        6.	The Team
                    </h2>
                    <p>
                        With over 100 years of combined industry experience, our strategically selected and highly qualified growth team comes from diverse backgrounds. We all strive to build a better tomorrow and share expertise and opportunities. The team is led by Yves Rugasaguhunga, a native of Rwanda, who founded and leads PrimECS LLC as its President. Yves' decade-long practice in infrastructure design and construction has focused on large project delivery, including bridges, roads, tunnels, buildings, and rail. A licensed Professional Engineer (PE) in several US states, Yves holds a BS and an MS in Civil and Geotechnical Engineering from NYU - Tandon School of Engineering. He created AEC360 LI to promote the industry and fulfill his wish to empower the youth through self-directed learning. 
                    </p>
                    <h2>
                        7.	 Partnerships
                    </h2>
                    <p>
                        We partner with private and public organizations, including schools, governments, NGOs, developers, and contractors, to provide targeted and extensive skills.  Our partnership goes beyond an educational association.  We work with AEC firms in the US and Africa to provide quality expertise.  PrimECS LLC's engineering and management consulting services are available to our partners.  Proceeds from our services fund our activities.  Thus, we seek partnerships that help us provide affordable programs for our participants, especially those with limited means.
                    </p>
                    <h2>
                        8.	Pricing Model
                    </h2>
                    <p>
                        We offer both free and paid programs. Paid programs are available at reasonable fees, advertised with the call for applications, and vary depending on the scope and desired level of training.  We offer discounted rates for long-term commitments and organized groups.
                    </p>

                </div>
            </div>
        </div>
    </div>
        <!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/8.1.1/firebase.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-analytics.js"></script>
    <script>
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        var firebaseConfig = {
          apiKey: "AIzaSyDV8mW8bweN6YOg0OKgRZ9umOVs_UUN-pA",
          authDomain: "primecs-1cbfc.firebaseapp.com",
          projectId: "primecs-1cbfc",
          storageBucket: "primecs-1cbfc.appspot.com",
          messagingSenderId: "33832366036",
          appId: "1:33832366036:web:cc0d5c26b3c1b4690ff041",
          measurementId: "G-ETGHB4KYQF"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        firebase.analytics();
        var db = firebase.firestore();
        var userId;
        var courserBeingTaken;
        var globalUserId;
        var choosefile = document.getElementById("choosefile").onchange = function(){
            var storageRef = firebase.storage().ref();
            var userStorageRef = storageRef.child(String(userId));

            const selectedFile = document.getElementById('choosefile').files[0];
            document.getElementById("loader").style.display = "block";
            userStorageRef.put(selectedFile).then(function(snapshot) {
                endAccountControlSession();
                
                const fileDirectory = snapshot.ref.getDownloadURL().then(url=>{
                    console.log(url);
                    populateUserImages();
                    document.getElementById("loader").style.display = "none";
                }).catch(error=>{
                    alert(error);
                    console.log(error);
                })
            }).catch(error=>{
                alert(String(error));
                console.log(error);
            });

        };


        switchTabFor(0);
        loadUserClasses();
        populateUserImages();

        function loadUserClasses() {
            var enrolledPrograms = document.getElementById("enrolledPrograms");
            var cookies = document.cookie
                .split(';')
                .map(cookie => cookie.split('='))
                .reduce((accumulator, [key, value]) => ({
                    ...accumulator,
                    [key.trim()]: decodeURIComponent(value)
                }), {});

            console.log(`Starting retrieving`);
            console.log(cookies);

            userId = String(cookies.nick);
            var uidLength = userId.split(``).length;

            document.cookie = "nick=; expires=Thu, 01 Jan 1970 00:00:00 UTC;";

            if ((userId == "undefined") && (globalUserId == "")) {
                location.href = 'signinup.html';

            } else {
                globalUserId = userId;
                try {
                    document.getElementById("loader").style.display = "block";
                    db.collection('users').doc(userId).get().then((data) => {
                        document.getElementById("loader").style.display = "none";
                        courserBeingTaken = data.data().courses.trim().split(` `);
                        console.log(courserBeingTaken);

                        if ((courserBeingTaken.length !== 0)) {
                            for (let course of courserBeingTaken) {

                                if (course != "") {
                                enrolledPrograms.innerHTML += `
                                <div class="rectangle">
                                <h3>${course}</h3>
                                <p>${fetchContent(String(course))}</p>
                                <button onclick="createCookie(${uidLength})">Continue</button>
                                <button onclick="exitClass('${course}')">Exit Course</button>
                                </div>
                                `;
                                document.getElementById("enrollmentCLASSES").innerHTML+=`

                                <div class="enrollmentClass">
                                <p>${course}</p>
                                </div>
                                `
                                }

                            }
                        }

                        if (courserBeingTaken.length !== 0) {
                            document.getElementById("nothing").style.display = "none";
                        }

                    }).catch(err => {
                        alert(err+"Line 239");
                    })
                } catch (err) {
                    alert(err);
                    console.log(err);
                }
            }
            document.cookie = "_hush="+userId;
        }

        function createCookie(uidLength) {
            document.cookie = `notallowed=` + String(uidLength == 0);
            location.href = `aec360p.html`;
            console.log(document.cookie);
            console.log(`Called`);
        }

        function enroll(newClass) {
            var stringCourse = "";
            var isEnrolled = false;
            console.log(courserBeingTaken);
            for (let course of courserBeingTaken) {
                stringCourse += course + " ";
                if (course == String(newClass).replaceAll(` `, `_`)) {
                    isEnrolled = true;
                }
            }
            console.log(stringCourse);
            stringCourse += String(newClass).replaceAll(` `, `_`);
            if (!isEnrolled) {
                document.getElementById("loader").style.display = "block";
                db.collection('users').doc(userId).set({
                    courses: stringCourse
                }).then(() => {
                    document.getElementById("loader").style.display = "none";
                    document.cookie = "nick="+userId;    
            location.href = `lessons.html`;
                });
            } else {
                alert(`Already Enrolled`);
            }
            //loadUserClassesWithParam(userId); 
        }

        function fetchContent(subject) {
            var descriptionObject = {
                AEC360_Business: "A company, abbreviated as co., is a legal entity representing an association of people, whether natural, legal or a mixture of both, with a specific objective. ",
                AEC360_Custom: " It is the custom to give gifts at Christmas time. Habit, applied particularly to an individual, implies such repetition of the same action as to develop a natural, spontaneous, or rooted tendency or inclination to perform it: to make a habit of reading the newspapers. Practice applies to a set of fixed habits or an ordered procedure in conducting activities: It is his practice to verify all statements.",
                AEC360_Executive: "The executive is the branch of government exercising authority in and holding responsibility for the governance of a state. The executive executes and enforces law.",
                AEC360_Professional: "A profession is an occupation founded upon specialized educational training, the purpose of which is to supply disinterested objective counsel and service to others, for a direct and definite compensation, wholly apart from expectation of other business gain.",
            }
            return descriptionObject[subject];
        }

        //FUNCTION TO RELOAD DATA FROM DATABASE AFTER ENROLLMENT
        //IT SHOULD ALSO HAVE TO MANIPULATE VIEWS AS THE FIRST FUNCTION
        function loadUserClassesWithParam(PARAM_USERID) {
            var enrolledPrograms = document.getElementById("enrolledPrograms");
            enrolledPrograms.innerHTML = "<small>ENROLLED PROGRAMS</small>";
            try {
                db.collection('users').doc(PARAM_USERID).get().then((data) => {
                    console.log(data.data());
                    courserBeingTaken = data.data().courses.split(` `);
                    console.log(courserBeingTaken);
                    if ((courserBeingTaken.length !== 0)) {
                        for (let course of courserBeingTaken) {
                            if (course != "") {
                                enrolledPrograms.innerHTML += `
                                <div class="rectangle">
                                <h3>${course}</h3>
                                <p>${fetchContent(String(course))}</p>
                                <button onclick="createCookie(${uidLength})">Continue</button>
                                <button onclick="exitClass('${course}')">Exit Course</button>
                                </div>
                                `;
                            }
                        }
                    }
                    if (courserBeingTaken.length !== 0) {
                        document.getElementById("nothing").style.display = "none";
                    }
                }).catch(err => {
                    alert(err);
                    console.log(err);
                })
            } catch (err) {

            }
            document.cookie = "_hush="+userId;
        }

        function switchTabFor(NUMBER){
            var tabs = document.getElementsByClassName("col2");
            var navigators = document.getElementsByClassName("clickItem");
            for(let tab of tabs){
                tab.style.display = "none";
            }
            for(let navigator of navigators){
                navigator.style.color = "#EAEDE6";
            }
            tabs[NUMBER].style.display = "block";
            navigators[NUMBER].style.color = "#8FE423";
        }
        function logout(){
            firebase.auth().signOut().then(()=>{
                location.href = `signinup.html`;
            }).catch(err=>{

            })
        }

        function startAccountControlSession(){
            var parent = document.getElementById("accountcontrol");
            var child = document.getElementById("center");

            parent.style.display = "block";
            child.style.display = "flex";

        }
        function endAccountControlSession(){
            var parent = document.getElementById("accountcontrol");
            var child = document.getElementById("center");

            parent.style.display = "none";
            child.style.display = "none";

        }
        function populateUserImages(){
            firebase.storage().ref().child(String(userId)).getDownloadURL().then((url)=>{
                document.getElementById("userprofilepicture").style.backgroundImage = `url(${url});`;
                document.getElementById("userProfile").style.backgroundImage = `url(${url});`;
            }).catch(error=>{

            })
        }


        function exitClass(newClass) {
            var stringCourse = "";
            console.log(stringCourse);
            for( var i = 0; i < courserBeingTaken.length; i++){ 
                    if ( courserBeingTaken[i] === String(newClass)) { 
                        courserBeingTaken.splice(i, 1); 
                    }
            }
            
            for (let course of courserBeingTaken) {
                stringCourse += course + " ";
            }
            document.getElementById("loader").style.display = "block";
            db.collection('users').doc(userId).set({
            courses: stringCourse
            }).then(() => {
            document.getElementById("loader").style.display = "none";
            document.cookie = "nick="+userId;    
            location.href = `lessons.html`;
            });
            
        }




         </script>
</body>
</html>